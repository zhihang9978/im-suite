# ğŸ¤– æœºå™¨äººç³»ç»Ÿå®Œæ•´å®ç°æŠ¥å‘Š v1.6.0

**ç‰ˆæœ¬**: v1.6.0  
**å‘å¸ƒæ—¥æœŸ**: 2024-12-19  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æ¨é€

---

## ğŸ¯ å®ç°çš„åŠŸèƒ½

### æ ¸å¿ƒåŠŸèƒ½æ€»è§ˆ

âœ… **APIæ–¹å¼** - é€šè¿‡HTTP APIè°ƒç”¨æœºå™¨äººåŠŸèƒ½  
âœ… **èŠå¤©æ–¹å¼** - é€šè¿‡èŠå¤©ç•Œé¢ä¸æœºå™¨äººäº¤äº’  
âœ… **åå°ç®¡ç†** - åœ¨è¶…çº§ç®¡ç†å‘˜åå°ç»Ÿä¸€ç®¡ç†  

---

## ğŸ“Š ä¸‰ç§ä½¿ç”¨æ–¹å¼å¯¹æ¯”

| æ–¹å¼ | é€‚ç”¨åœºæ™¯ | ç”¨æˆ·ç±»å‹ | éš¾åº¦ |
|------|----------|----------|------|
| **APIè°ƒç”¨** | è‡ªåŠ¨åŒ–è„šæœ¬ã€æ‰¹é‡æ“ä½œ | å¼€å‘è€… | â­â­â­ |
| **èŠå¤©äº¤äº’** | ä¸´æ—¶æ“ä½œã€å¿«é€Ÿç®¡ç† | æˆæƒç”¨æˆ· | â­ |
| **åå°ç®¡ç†** | é…ç½®ç®¡ç†ã€æƒé™æ§åˆ¶ | è¶…çº§ç®¡ç†å‘˜ | â­â­ |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æœºå™¨äººç³»ç»Ÿ v1.6.0                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  1ï¸âƒ£ åå°ç®¡ç†ç•Œé¢ï¼ˆSystem.vueï¼‰                         â”‚
â”‚     â”œâ”€â”€ ğŸ¤– æœºå™¨äººç®¡ç†ï¼ˆåˆ›å»ºã€é…ç½®ã€ç»Ÿè®¡ï¼‰              â”‚
â”‚     â”œâ”€â”€ ğŸ‘¤ æœºå™¨äººç”¨æˆ·ï¼ˆåˆ›å»ºèŠå¤©è´¦å·ï¼‰                  â”‚
â”‚     â””â”€â”€ ğŸ”‘ ç”¨æˆ·æˆæƒï¼ˆæˆæƒ/æ’¤é”€æƒé™ï¼‰                   â”‚
â”‚                                                          â”‚
â”‚  2ï¸âƒ£ èŠå¤©äº¤äº’å±‚ï¼ˆBotChatHandlerï¼‰                       â”‚
â”‚     â”œâ”€â”€ å‘½ä»¤è§£æï¼ˆ/create, /delete, /listç­‰ï¼‰         â”‚
â”‚     â”œâ”€â”€ æƒé™æ£€æŸ¥ï¼ˆBotUserPermissionï¼‰                  â”‚
â”‚     â”œâ”€â”€ æ“ä½œæ‰§è¡Œï¼ˆBotServiceï¼‰                         â”‚
â”‚     â””â”€â”€ å›å¤å‘é€ï¼ˆMessageServiceï¼‰                     â”‚
â”‚                                                          â”‚
â”‚  3ï¸âƒ£ APIè°ƒç”¨å±‚ï¼ˆBotServiceï¼‰                            â”‚
â”‚     â”œâ”€â”€ API Keyè®¤è¯ï¼ˆBotAuthMiddlewareï¼‰               â”‚
â”‚     â”œâ”€â”€ é€Ÿç‡é™åˆ¶ï¼ˆRedisï¼‰                              â”‚
â”‚     â”œâ”€â”€ æƒé™æ£€æŸ¥ï¼ˆCheckBotPermissionï¼‰                 â”‚
â”‚     â””â”€â”€ æ“ä½œæ‰§è¡Œï¼ˆCreate/Delete Userï¼‰                 â”‚
â”‚                                                          â”‚
â”‚  4ï¸âƒ£ æ•°æ®å±‚ï¼ˆModelsï¼‰                                   â”‚
â”‚     â”œâ”€â”€ Botï¼ˆæœºå™¨äººé…ç½®ï¼‰                              â”‚
â”‚     â”œâ”€â”€ BotUserï¼ˆèŠå¤©è´¦å·ï¼‰                            â”‚
â”‚     â”œâ”€â”€ BotUserPermissionï¼ˆä½¿ç”¨æˆæƒï¼‰                 â”‚
â”‚     â”œâ”€â”€ BotAPILogï¼ˆè°ƒç”¨æ—¥å¿—ï¼‰                          â”‚
â”‚     â””â”€â”€ Userï¼ˆç”¨æˆ·æ•°æ®ï¼Œå«CreatedByBotIDï¼‰            â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ å®Œæ•´æ–‡ä»¶æ¸…å•

### åç«¯æ–‡ä»¶ï¼ˆGoï¼‰

```
im-backend/
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ bot.go                           # Bot, BotAPILog, BotUser, BotUserPermission
â”‚   â”‚   â””â”€â”€ user.go                          # æ·»åŠ  CreatedByBotID, BotManageable
â”‚   â”‚
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ bot_service.go                   # æœºå™¨äººæ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ bot_chat_handler.go              # èŠå¤©å‘½ä»¤å¤„ç†
â”‚   â”‚   â””â”€â”€ bot_user_management_service.go   # ç”¨æˆ·æˆæƒç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ bot_controller.go                # æœºå™¨äººAPIæ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ bot_user_controller.go           # ç”¨æˆ·æˆæƒæ§åˆ¶å™¨
â”‚   â”‚
â”‚   â””â”€â”€ middleware/
â”‚       â””â”€â”€ bot_auth.go                      # Botè®¤è¯ä¸­é—´ä»¶
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.go                          # æ·»åŠ Botç›¸å…³è¡¨è¿ç§»
â”‚
â””â”€â”€ main.go                                  # è·¯ç”±é…ç½®
```

### å‰ç«¯æ–‡ä»¶ï¼ˆVueï¼‰

```
im-admin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â””â”€â”€ System.vue                       # æ•´åˆçš„ç®¡ç†é¡µé¢ï¼ˆå«4ä¸ªæ ‡ç­¾ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ router/
â”‚       â””â”€â”€ index.js                         # è·¯ç”±é…ç½®ï¼ˆæ— éœ€ç‹¬ç«‹è·¯ç”±ï¼‰
```

### æ–‡æ¡£æ–‡ä»¶

```
docs/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ bot-api.md                           # APIè°ƒç”¨å®Œæ•´æ–‡æ¡£
â”‚   â””â”€â”€ bot-api-restricted.md               # å—é™ç‰ˆæœ¬APIæ–‡æ¡£
â”‚
â”œâ”€â”€ BOT_SYSTEM.md                            # ç³»ç»Ÿæ¶æ„æ–‡æ¡£
â”œâ”€â”€ BOT_CHAT_GUIDE.md                        # èŠå¤©ä½¿ç”¨æŒ‡å—
â””â”€â”€ INTEGRATED_BOT_ADMIN_GUIDE.md            # åå°æ•´åˆæŒ‡å—
```

---

## ğŸ¨ ç®¡ç†åå°ç•Œé¢

### è®¿é—®è·¯å¾„

```
ç™»å½•ç®¡ç†åå° â†’ ç³»ç»Ÿç®¡ç† (/system)
```

### 4ä¸ªæ ‡ç­¾é¡µ

#### 1. ç³»ç»Ÿä¿¡æ¯ï¼ˆé»˜è®¤ï¼‰
- ç³»ç»Ÿç‰ˆæœ¬: v1.6.0
- è¿è¡ŒçŠ¶æ€ã€æœåŠ¡çŠ¶æ€
- ç³»ç»Ÿé…ç½®ã€ç³»ç»Ÿæ“ä½œ

#### 2. ğŸ¤– æœºå™¨äººç®¡ç†
**åŠŸèƒ½**:
- åˆ›å»ºæœºå™¨äºº
- æŸ¥çœ‹æœºå™¨äººåˆ—è¡¨
- æŸ¥çœ‹ç»Ÿè®¡ï¼ˆæ€»è°ƒç”¨ã€æˆåŠŸã€å¤±è´¥ã€æˆåŠŸç‡ï¼‰
- åˆ‡æ¢çŠ¶æ€ï¼ˆå¯ç”¨/åœç”¨ï¼‰
- æŸ¥çœ‹è¯¦æƒ…
- åˆ é™¤æœºå™¨äºº

**è¡¨æ ¼åˆ—**:
```
| åç§° | ç±»å‹ | æè¿° | çŠ¶æ€ | ç»Ÿè®¡ | æ“ä½œ |
```

#### 3. ğŸ‘¤ æœºå™¨äººç”¨æˆ·
**åŠŸèƒ½**:
- ä¸ºæœºå™¨äººåˆ›å»ºèŠå¤©è´¦å·
- æŸ¥çœ‹æœºå™¨äººç”¨æˆ·åˆ—è¡¨
- åˆ é™¤æœºå™¨äººç”¨æˆ·

**æç¤ºä¿¡æ¯**:
```
ğŸ’¡ ä¸ºæœºå™¨äººåœ¨ç³»ç»Ÿä¸­åˆ›å»ºç”¨æˆ·è´¦å·ï¼Œä½¿å…¶å¯ä»¥åœ¨èŠå¤©ç•Œé¢ä¸­ä¸ç”¨æˆ·äº¤äº’ã€‚
```

**è¡¨æ ¼åˆ—**:
```
| æœºå™¨äºº | ç”¨æˆ·å | æ˜µç§° | ç”¨æˆ·ID | çŠ¶æ€ | åˆ›å»ºæ—¶é—´ | æ“ä½œ |
```

#### 4. ğŸ”‘ ç”¨æˆ·æˆæƒ
**åŠŸèƒ½**:
- æˆæƒç”¨æˆ·ä½¿ç”¨æœºå™¨äºº
- æŸ¥çœ‹æˆæƒåˆ—è¡¨
- æ’¤é”€æƒé™
- è®¾ç½®è¿‡æœŸæ—¶é—´

**è¡¨æ ¼åˆ—**:
```
| ç”¨æˆ· | æœºå™¨äºº | æˆæƒè€… | æˆæƒæ—¶é—´ | è¿‡æœŸæ—¶é—´ | çŠ¶æ€ | æ“ä½œ |
```

---

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

### 1. è¶…çº§ç®¡ç†å‘˜è®¾ç½®ï¼ˆä¸€æ¬¡æ€§ï¼‰

```
æ­¥éª¤1: åˆ›å»ºæœºå™¨äºº
ä½ç½®: ç³»ç»Ÿç®¡ç† â†’ ğŸ¤– æœºå™¨äººç®¡ç† â†’ â• åˆ›å»ºæœºå™¨äºº
å¡«å†™: åç§°ã€æè¿°ã€ç±»å‹ã€æƒé™
ç»“æœ: è·å¾—APIå¯†é’¥ï¼ˆä¿å­˜ï¼ï¼‰

æ­¥éª¤2: åˆ›å»ºæœºå™¨äººç”¨æˆ·
ä½ç½®: ç³»ç»Ÿç®¡ç† â†’ ğŸ‘¤ æœºå™¨äººç”¨æˆ· â†’ â• åˆ›å»ºæœºå™¨äººç”¨æˆ·
å¡«å†™: é€‰æ‹©æœºå™¨äººã€ç”¨æˆ·åã€æ˜µç§°
ç»“æœ: æœºå™¨äººåœ¨ç³»ç»Ÿä¸­æœ‰äº†èŠå¤©è´¦å·

æ­¥éª¤3: æˆæƒç”¨æˆ·
ä½ç½®: ç³»ç»Ÿç®¡ç† â†’ ğŸ”‘ ç”¨æˆ·æˆæƒ â†’ â• æˆæƒç”¨æˆ·
å¡«å†™: ç”¨æˆ·IDã€æœºå™¨äººã€è¿‡æœŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
ç»“æœ: æŒ‡å®šç”¨æˆ·å¯ä»¥ä½¿ç”¨æœºå™¨äºº
```

### 2. æˆæƒç”¨æˆ·ä½¿ç”¨ï¼ˆæ—¥å¸¸ï¼‰

```
æ­¥éª¤1: æœç´¢æœºå™¨äºº
åœ¨èŠå¤©åº”ç”¨ä¸­æœç´¢: "userbot"

æ­¥éª¤2: å¼€å§‹å¯¹è¯
ç‚¹å‡»æœºå™¨äººï¼Œå¼€å§‹èŠå¤©

æ­¥éª¤3: å‘é€å‘½ä»¤
è¾“å…¥: /help
      /create phone=... username=... password=...
      /list
      /delete user_id=... reason=...

æ­¥éª¤4: æŸ¥çœ‹å›å¤
æœºå™¨äººè‡ªåŠ¨å›å¤æ‰§è¡Œç»“æœ
```

### 3. ç›‘æ§å’Œç»´æŠ¤ï¼ˆå®šæœŸï¼‰

```
ä½ç½®: ç³»ç»Ÿç®¡ç† â†’ ğŸ¤– æœºå™¨äººç®¡ç†

æŸ¥çœ‹ç»Ÿè®¡:
- æ€»è°ƒç”¨æ¬¡æ•°
- æˆåŠŸ/å¤±è´¥æ¬¡æ•°
- æˆåŠŸç‡
- æœ€åä½¿ç”¨æ—¶é—´

å¿…è¦æ—¶:
- åœç”¨å¼‚å¸¸æœºå™¨äºº
- é‡æ–°ç”ŸæˆAPIå¯†é’¥
- è°ƒæ•´æƒé™é…ç½®
```

---

## ğŸ“Š æ•°æ®åº“è¡¨

### 5å¼ æ–°è¡¨

| è¡¨å | è®°å½•æ•° | è¯´æ˜ |
|------|--------|------|
| bots | N | æœºå™¨äººé…ç½® |
| bot_api_logs | NÃ—1000 | APIè°ƒç”¨æ—¥å¿— |
| bot_users | N | æœºå™¨äººèŠå¤©è´¦å· |
| bot_user_permissions | NÃ—M | ç”¨æˆ·æˆæƒè®°å½• |
| users | +å­—æ®µ | æ·»åŠ CreatedByBotIDã€BotManageable |

### å…³ç³»å›¾

```
Bot (1) â†â†’ (1) BotUser (1) â†â†’ (1) User(ç³»ç»Ÿç”¨æˆ·)
 â†“
BotAPILog (N)

Bot (1) â†â†’ (N) BotUserPermission (N) â†â†’ (1) User(æˆæƒç”¨æˆ·)

User (N) â†â†’ (1) Bot (é€šè¿‡CreatedByBotID)
```

---

## ğŸ” å®‰å…¨å’Œæƒé™

### ä¸‰å±‚æƒé™æ§åˆ¶

#### 1. é¡µé¢è®¿é—®æƒé™
```
ç³»ç»Ÿç®¡ç†é¡µé¢:
- user: âŒ æ— æ³•è®¿é—®
- admin: âš ï¸ éƒ¨åˆ†åŠŸèƒ½ï¼ˆä»…ç”¨æˆ·æˆæƒï¼‰
- super_admin: âœ… å…¨éƒ¨åŠŸèƒ½
```

#### 2. æœºå™¨äººæ“ä½œæƒé™
```
åˆ›å»ºç”¨æˆ·:
- éœ€è¦ create_user æƒé™
- å¼ºåˆ¶ role="user"
- è‡ªåŠ¨è®¾ç½® CreatedByBotID

åˆ é™¤ç”¨æˆ·:
- éœ€è¦ delete_user æƒé™
- æ£€æŸ¥ BotManageable=true
- æ£€æŸ¥ CreatedByBotID=bot.ID
```

#### 3. ç”¨æˆ·ä½¿ç”¨æƒé™
```
BotUserPermissionè¡¨:
- å¿…é¡»æœ‰æˆæƒè®°å½•
- is_active=true
- expires_at > now æˆ– null
```

---

## ğŸ“ˆ APIç«¯ç‚¹æ±‡æ€»

### è¶…çº§ç®¡ç†å‘˜APIï¼ˆ13ä¸ªï¼‰

**æœºå™¨äººç®¡ç†** (9ä¸ª):
```
POST   /api/super-admin/bots                          åˆ›å»ºæœºå™¨äºº
GET    /api/super-admin/bots                          è·å–åˆ—è¡¨
GET    /api/super-admin/bots/:id                      è·å–è¯¦æƒ…
PUT    /api/super-admin/bots/:id/permissions          æ›´æ–°æƒé™
PUT    /api/super-admin/bots/:id/status               åˆ‡æ¢çŠ¶æ€
DELETE /api/super-admin/bots/:id                      åˆ é™¤æœºå™¨äºº
GET    /api/super-admin/bots/:id/logs                 æŸ¥çœ‹æ—¥å¿—
GET    /api/super-admin/bots/:id/stats                æŸ¥çœ‹ç»Ÿè®¡
POST   /api/super-admin/bots/:id/regenerate-secret    é‡æ–°ç”Ÿæˆå¯†é’¥
```

**æœºå™¨äººç”¨æˆ·ç®¡ç†** (4ä¸ª):
```
POST   /api/super-admin/bot-users                     åˆ›å»ºæœºå™¨äººç”¨æˆ·
GET    /api/super-admin/bot-users/:bot_id             è·å–æœºå™¨äººç”¨æˆ·
DELETE /api/super-admin/bot-users/:bot_id             åˆ é™¤æœºå™¨äººç”¨æˆ·
GET    /api/super-admin/bot-users/:bot_id/permissions æŸ¥çœ‹æˆæƒåˆ—è¡¨
```

### ç®¡ç†å‘˜APIï¼ˆ2ä¸ªï¼‰

```
POST   /api/admin/bot-permissions                     æˆæƒç”¨æˆ·
DELETE /api/admin/bot-permissions/:user_id/:bot_id    æ’¤é”€æƒé™
```

### æœºå™¨äººAPIï¼ˆ2ä¸ªï¼‰

```
POST   /api/bot/users                                 åˆ›å»ºç”¨æˆ·
DELETE /api/bot/users                                 åˆ é™¤ç”¨æˆ·
```

### æ™®é€šç”¨æˆ·APIï¼ˆ1ä¸ªï¼‰

```
GET    /api/bot-permissions                           æŸ¥çœ‹è‡ªå·±çš„æƒé™
```

**æ€»è®¡**: 18ä¸ªæ–°APIç«¯ç‚¹

---

## ğŸ¨ ç®¡ç†åå°ç•Œé¢ç‰¹æ€§

### ä½¿ç”¨Element Plusç»„ä»¶

- **el-tabs** - æ ‡ç­¾é¡µç»„ç»‡
- **el-table** - æ•°æ®è¡¨æ ¼
- **el-dialog** - å¯¹è¯æ¡†
- **el-form** - è¡¨å•
- **el-button** - æŒ‰é’®
- **el-tag** - æ ‡ç­¾
- **el-alert** - æç¤ºä¿¡æ¯
- **el-message** - æ¶ˆæ¯æç¤º
- **el-message-box** - ç¡®è®¤å¯¹è¯æ¡†

### ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç³»ç»Ÿç®¡ç†                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ç³»ç»Ÿä¿¡æ¯] [ğŸ¤–æœºå™¨äººç®¡ç†] [ğŸ‘¤æœºå™¨äººç”¨æˆ·] [ğŸ”‘ç”¨æˆ·æˆæƒ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  å½“å‰æ ‡ç­¾é¡µå†…å®¹                                  â”‚
â”‚  - æ•°æ®è¡¨æ ¼                                      â”‚
â”‚  - æ“ä½œæŒ‰é’®                                      â”‚
â”‚  - ç»Ÿè®¡ä¿¡æ¯                                      â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¬ èŠå¤©å‘½ä»¤ç³»ç»Ÿ

### 5ä¸ªå‘½ä»¤

| å‘½ä»¤ | æ ¼å¼ | åŠŸèƒ½ |
|------|------|------|
| **/help** | `/help` | æ˜¾ç¤ºå¸®åŠ© |
| **/create** | `/create phone=... username=... password=...` | åˆ›å»ºç”¨æˆ· |
| **/delete** | `/delete user_id=... reason=...` | åˆ é™¤ç”¨æˆ· |
| **/list** | `/list [limit=10]` | åˆ—å‡ºç”¨æˆ· |
| **/info** | `/info user_id=...` | ç”¨æˆ·è¯¦æƒ… |

### å‘½ä»¤ç¤ºä¾‹

```
ğŸ“ åˆ›å»ºç”¨æˆ·:
/create phone=13800138001 username=test1 password=Pass123! nickname=æµ‹è¯•1

âœ… æœºå™¨äººå›å¤:
ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼
- ID: 101
- ç”¨æˆ·å: test1
- æ‰‹æœºå·: 13800138001
...

ğŸ“‹ æŸ¥çœ‹åˆ—è¡¨:
/list limit=5

âœ… æœºå™¨äººå›å¤:
ç”¨æˆ·åˆ—è¡¨ (å…± 3 ä¸ª)
1. test1 (ID:101)
2. test2 (ID:102)
3. test3 (ID:103)

ğŸ—‘ï¸ åˆ é™¤ç”¨æˆ·:
/delete user_id=101 reason=æµ‹è¯•å®Œæˆ

âœ… æœºå™¨äººå›å¤:
ç”¨æˆ·åˆ é™¤æˆåŠŸï¼
- ç”¨æˆ·å: test1
- åˆ é™¤åŸå› : æµ‹è¯•å®Œæˆ
...
```

---

## ğŸ”’ å®‰å…¨æœºåˆ¶

### 1. å¤šå±‚æƒé™éªŒè¯

```
å±‚çº§1: æœºå™¨äººæœ¬èº«çš„æƒé™
- Bot.permissionså­—æ®µ
- create_user, delete_userç­‰

å±‚çº§2: ç”¨æˆ·ä½¿ç”¨æœºå™¨äººçš„æƒé™
- BotUserPermissionè¡¨
- is_active=true
- expires_atæ£€æŸ¥

å±‚çº§3: æ“ä½œå¯¹è±¡çš„é™åˆ¶
- åªèƒ½åˆ›å»ºæ™®é€šç”¨æˆ·ï¼ˆrole=userï¼‰
- åªèƒ½åˆ é™¤æœ¬æœºå™¨äººåˆ›å»ºçš„ç”¨æˆ·
- æ£€æŸ¥BotManageableæ ‡è®°
```

### 2. APIå¯†é’¥å®‰å…¨

- bcryptåŠ å¯†å­˜å‚¨
- åªåœ¨åˆ›å»ºæ—¶æ˜¾ç¤ºä¸€æ¬¡
- æ”¯æŒé‡æ–°ç”Ÿæˆ
- é€Ÿç‡é™åˆ¶ä¿æŠ¤

### 3. å®¡è®¡è¿½è¸ª

```
BotAPILogè¡¨è®°å½•:
- è°ƒç”¨ç«¯ç‚¹
- è¯·æ±‚å‚æ•°
- å“åº”ç»“æœ
- è€—æ—¶ç»Ÿè®¡
- IPåœ°å€
- æ—¶é—´æˆ³
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹æ±‡æ€»

### ç¤ºä¾‹1: åå°åˆ›å»ºæœºå™¨äºº

```
1. ç™»å½•ç®¡ç†åå°ï¼ˆsuper_adminè´¦å·ï¼‰
2. è¿›å…¥"ç³»ç»Ÿç®¡ç†"
3. åˆ‡æ¢åˆ°"ğŸ¤– æœºå™¨äººç®¡ç†"æ ‡ç­¾
4. ç‚¹å‡»"â• åˆ›å»ºæœºå™¨äºº"
5. å¡«å†™è¡¨å•:
   - åç§°: æµ‹è¯•æœºå™¨äºº
   - æè¿°: ç”¨äºæµ‹è¯•
   - ç±»å‹: internal
   - æƒé™: âœ… create_user  âœ… delete_user
6. ç‚¹å‡»"åˆ›å»º"
7. âš ï¸ å¤åˆ¶å¹¶ä¿å­˜APIå¯†é’¥
8. ç‚¹å‡»"æˆ‘å·²ä¿å­˜"
```

### ç¤ºä¾‹2: åå°åˆ›å»ºæœºå™¨äººç”¨æˆ·

```
1. åˆ‡æ¢åˆ°"ğŸ‘¤ æœºå™¨äººç”¨æˆ·"æ ‡ç­¾
2. ç‚¹å‡»"â• åˆ›å»ºæœºå™¨äººç”¨æˆ·"
3. å¡«å†™:
   - é€‰æ‹©æœºå™¨äºº: æµ‹è¯•æœºå™¨äºº
   - ç”¨æˆ·å: testbot
   - æ˜µç§°: æµ‹è¯•æœºå™¨äºº
4. ç‚¹å‡»"åˆ›å»º"
5. âœ… æˆåŠŸæç¤º
```

### ç¤ºä¾‹3: åå°æˆæƒç”¨æˆ·

```
1. åˆ‡æ¢åˆ°"ğŸ”‘ ç”¨æˆ·æˆæƒ"æ ‡ç­¾
2. ç‚¹å‡»"â• æˆæƒç”¨æˆ·"
3. å¡«å†™:
   - ç”¨æˆ·ID: 5
   - æœºå™¨äºº: æµ‹è¯•æœºå™¨äºº
   - è¿‡æœŸæ—¶é—´: (ç•™ç©º)
4. ç‚¹å‡»"æˆæƒ"
5. âœ… æˆåŠŸæç¤º
```

### ç¤ºä¾‹4: ç”¨æˆ·èŠå¤©ä½¿ç”¨

```
1. ç”¨æˆ·ç™»å½•èŠå¤©åº”ç”¨
2. æœç´¢"testbot"
3. ç‚¹å‡»å¼€å§‹å¯¹è¯
4. è¾“å…¥: /help
5. æŸ¥çœ‹å‘½ä»¤åˆ—è¡¨
6. è¾“å…¥: /create phone=13800138001 username=user1 password=Pass123!
7. æŸ¥çœ‹æœºå™¨äººå›å¤
8. è¾“å…¥: /list
9. æŸ¥çœ‹åˆ›å»ºçš„ç”¨æˆ·åˆ—è¡¨
```

---

## ğŸ“Š ç»Ÿè®¡æ•°æ®

### ä»£ç ç»Ÿè®¡

| ç±»å‹ | æ•°é‡ |
|------|------|
| **åç«¯æ–‡ä»¶** | 10ä¸ª |
| **å‰ç«¯æ–‡ä»¶** | 2ä¸ª |
| **æ–‡æ¡£æ–‡ä»¶** | 5ä¸ª |
| **æ€»ä»£ç è¡Œ** | ~4,500è¡Œ |
| **APIç«¯ç‚¹** | 18ä¸ª |
| **æ•°æ®è¡¨** | 5ä¸ª |
| **èŠå¤©å‘½ä»¤** | 5ä¸ª |

### åŠŸèƒ½ç»Ÿè®¡

| åŠŸèƒ½æ¨¡å— | å®Œæˆåº¦ |
|----------|--------|
| APIè°ƒç”¨æ–¹å¼ | âœ… 100% |
| èŠå¤©äº¤äº’æ–¹å¼ | âœ… 100% |
| åå°ç®¡ç†ç•Œé¢ | âœ… 100% |
| æƒé™æ§åˆ¶ | âœ… 100% |
| æ“ä½œå®¡è®¡ | âœ… 100% |
| æ–‡æ¡£ | âœ… 100% |

---

## ğŸ¯ ä¸‰ç§ä½¿ç”¨æ–¹å¼è¯¦è§£

### æ–¹å¼1: APIè°ƒç”¨ï¼ˆé€‚åˆå¼€å‘è€…ï¼‰

**ç”¨é€”**: æ‰¹é‡æ“ä½œã€è‡ªåŠ¨åŒ–è„šæœ¬

**ç¤ºä¾‹**:
```python
import requests

headers = {
    "X-Bot-Auth": "Bot {api_key}:{api_secret}",
    "Content-Type": "application/json"
}

# æ‰¹é‡åˆ›å»º100ä¸ªç”¨æˆ·
for i in range(1, 101):
    requests.post(
        "http://localhost:8080/api/bot/users",
        json={
            "phone": f"1380013{i:04d}",
            "username": f"user{i}",
            "password": "Pass123!"
        },
        headers=headers
    )
```

---

### æ–¹å¼2: èŠå¤©äº¤äº’ï¼ˆé€‚åˆæˆæƒç”¨æˆ·ï¼‰

**ç”¨é€”**: å¿«é€Ÿåˆ›å»ºã€ä¸´æ—¶ç®¡ç†

**ç¤ºä¾‹**:
```
åœºæ™¯: è¿ç»´äººå‘˜éœ€è¦å¿«é€Ÿåˆ›å»ºæµ‹è¯•è´¦å·

èŠå¤©æ“ä½œ:
1. æ‰“å¼€èŠå¤©ï¼Œæœç´¢"userbot"
2. è¾“å…¥: /create phone=13800138001 username=test1 password=Test123!
3. æœºå™¨äººå›å¤: âœ… ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼
4. è¾“å…¥: /create phone=13800138002 username=test2 password=Test123!
5. æœºå™¨äººå›å¤: âœ… ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼
6. è¾“å…¥: /list
7. æœºå™¨äººå›å¤: æ˜¾ç¤º2ä¸ªç”¨æˆ·çš„åˆ—è¡¨

è€—æ—¶: ä¸åˆ°1åˆ†é’Ÿ
```

---

### æ–¹å¼3: åå°ç®¡ç†ï¼ˆé€‚åˆç®¡ç†å‘˜ï¼‰

**ç”¨é€”**: é…ç½®ç®¡ç†ã€æƒé™æ§åˆ¶ã€ç»Ÿè®¡æŸ¥çœ‹

**ç¤ºä¾‹**:
```
åœºæ™¯: ç®¡ç†å‘˜éœ€è¦æˆæƒæ–°å‘˜å·¥ä½¿ç”¨æœºå™¨äºº

åå°æ“ä½œ:
1. ç™»å½•ç®¡ç†åå°
2. ç³»ç»Ÿç®¡ç† â†’ ğŸ”‘ ç”¨æˆ·æˆæƒ
3. ç‚¹å‡»"â• æˆæƒç”¨æˆ·"
4. å¡«å†™ç”¨æˆ·ID: 15
5. é€‰æ‹©æœºå™¨äºº: ç”¨æˆ·ç®¡ç†æœºå™¨äºº
6. ç‚¹å‡»"æˆæƒ"
7. âœ… å®Œæˆ

è€—æ—¶: ä¸åˆ°30ç§’
```

---

## âœ… ç‰ˆæœ¬å¯¹æ¯”

### v1.5.0 â†’ v1.5.1 â†’ v1.6.0

| ç‰ˆæœ¬ | åŠŸèƒ½ | æ–¹å¼ |
|------|------|------|
| v1.5.0 | å®Œæ•´API | ä»…APIè°ƒç”¨ |
| v1.5.1 | å—é™API | ä»…APIè°ƒç”¨ |
| v1.6.0 | API + èŠå¤© + åå° | ä¸‰ç§æ–¹å¼ âœ¨ |

### v1.6.0æ–°å¢

- âœ… èŠå¤©å‘½ä»¤ç³»ç»Ÿ
- âœ… ç”¨æˆ·æˆæƒç®¡ç†
- âœ… åå°æ•´åˆç•Œé¢
- âœ… æœºå™¨äººç”¨æˆ·è´¦å·
- âœ… å®Œæ•´çš„æ–‡æ¡£

---

## ğŸ‰ æ€»ç»“

### å®ç°çš„ç›®æ ‡

âœ… **åˆ›å»ºæœºå™¨äºº** - åå°å¯è§†åŒ–æ“ä½œ  
âœ… **èŠå¤©äº¤äº’** - ç”¨æˆ·é€šè¿‡èŠå¤©ä½¿ç”¨  
âœ… **æƒé™ç®¡ç†** - æˆæƒæŒ‡å®šç”¨æˆ·  
âœ… **å®‰å…¨é™åˆ¶** - å¤šå±‚æƒé™æ§åˆ¶  
âœ… **æ•´åˆç•Œé¢** - ç»Ÿä¸€åœ¨ç³»ç»Ÿç®¡ç†é¡µé¢  

### æ ¸å¿ƒä¼˜åŠ¿

ğŸ¯ **ä¸‰ç§ä½¿ç”¨æ–¹å¼**ï¼š
- APIè°ƒç”¨ï¼šæ‰¹é‡æ“ä½œ
- èŠå¤©äº¤äº’ï¼šä¾¿æ·ç®¡ç†
- åå°ç®¡ç†ï¼šé›†ä¸­é…ç½®

ğŸ”’ **å®‰å…¨å¯æ§**ï¼š
- æƒé™ä¸¥æ ¼æ§åˆ¶
- æ“ä½œå¯å®¡è®¡
- ç”¨æˆ·å¯æˆæƒ

ğŸ“± **ç”¨æˆ·å‹å¥½**ï¼š
- å›¾å½¢åŒ–ç•Œé¢
- å‘½ä»¤å¼äº¤äº’
- å³æ—¶åé¦ˆ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **APIæ–‡æ¡£**: `docs/api/bot-api-restricted.md`
2. **èŠå¤©æŒ‡å—**: `docs/BOT_CHAT_GUIDE.md`
3. **åå°æŒ‡å—**: `docs/INTEGRATED_BOT_ADMIN_GUIDE.md`
4. **ç³»ç»Ÿæ¶æ„**: `docs/BOT_SYSTEM.md`

---

**ç‰ˆæœ¬**: v1.6.0  
**çŠ¶æ€**: âœ… å®Œæˆ  
**æ¨é€**: âœ… GitHub  
**æäº¤**: 3a6d375

---

**å®Œç¾ï¼æœºå™¨äººç³»ç»Ÿç°å·²å®Œå…¨æ•´åˆåˆ°è¶…çº§ç®¡ç†å‘˜åå°ï¼** ğŸ‰

