# å®Œæ•´æƒé™ç”³è¯·æµç¨‹æŒ‡å—

**å¿—èˆªå¯†ä¿¡** - ç¡®ä¿åŠŸèƒ½æ­£å¸¸è¿è¡Œçš„æƒé™ç®¡ç†æ–¹æ¡ˆ

---

## ğŸ“‹ æƒé™ç”³è¯·åŸåˆ™

### æ ¸å¿ƒåŸåˆ™

1. âœ… **ä½¿ç”¨å‰ç”³è¯·** - åœ¨ä½¿ç”¨åŠŸèƒ½ä¹‹å‰å¿…é¡»å…ˆè·å¾—æƒé™
2. âœ… **ç³»ç»Ÿå¼¹çª—** - ä½¿ç”¨Androidç³»ç»ŸåŸç”Ÿæƒé™å¼¹çª—
3. âœ… **æ¸…æ™°è¯´æ˜** - å‘ç”¨æˆ·è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦è¯¥æƒé™
4. âœ… **ä¼˜é›…é™çº§** - æƒé™è¢«æ‹’ç»æ—¶æä¾›æ›¿ä»£æ–¹æ¡ˆæˆ–å¼•å¯¼
5. âœ… **é¿å…éªšæ‰°** - ä¸é‡å¤è¯·æ±‚å·²æ‹’ç»çš„æƒé™

---

## ğŸ¯ æƒé™ç±»å‹å’Œä½¿ç”¨åœºæ™¯

### 1. ç›¸æœºæƒé™ (CAMERA)

**ä½¿ç”¨åœºæ™¯ï¼š**
- ğŸ“¹ è§†é¢‘é€šè¯
- ğŸ“¸ æ‹ç…§å‘é€
- ğŸ¬ å½•åˆ¶è§†é¢‘

**ç”³è¯·æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»è§†é¢‘é€šè¯æŒ‰é’®æ—¶
- ç”¨æˆ·ç‚¹å‡»æ‹ç…§æŒ‰é’®æ—¶
- é¦–æ¬¡æ‰“å¼€ç›¸æœºç›¸å…³åŠŸèƒ½æ—¶

### 2. éº¦å…‹é£æƒé™ (RECORD_AUDIO)

**ä½¿ç”¨åœºæ™¯ï¼š**
- ğŸ¤ è¯­éŸ³é€šè¯
- ğŸ™ï¸ è¯­éŸ³æ¶ˆæ¯
- ğŸµ å½•éŸ³

**ç”³è¯·æ—¶æœºï¼š**
- ç”¨æˆ·å‘èµ·è¯­éŸ³/è§†é¢‘é€šè¯æ—¶
- ç”¨æˆ·æŒ‰ä½å½•éŸ³æŒ‰é’®æ—¶
- é¦–æ¬¡ä½¿ç”¨è¯­éŸ³åŠŸèƒ½æ—¶

### 3. å­˜å‚¨æƒé™ (READ/WRITE_EXTERNAL_STORAGE)

**ä½¿ç”¨åœºæ™¯ï¼š**
- ğŸ’¾ ä¿å­˜æ–‡ä»¶
- ğŸ“ è¯»å–æ–‡ä»¶
- ğŸ–¼ï¸ è®¿é—®ç›¸å†Œ

**ç”³è¯·æ—¶æœºï¼š**
- ç”¨æˆ·é€‰æ‹©å‘é€æ–‡ä»¶æ—¶
- ç”¨æˆ·ä¿å­˜æ–‡ä»¶æ—¶
- è®¿é—®ç›¸å†Œæ—¶

### 4. ä½ç½®æƒé™ (ACCESS_FINE_LOCATION)

**ä½¿ç”¨åœºæ™¯ï¼š**
- ğŸ“ åˆ†äº«ä½ç½®
- ğŸ—ºï¸ é™„è¿‘çš„äºº

**ç”³è¯·æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»åˆ†äº«ä½ç½®æ—¶
- ä½¿ç”¨ä½ç½®ç›¸å…³åŠŸèƒ½æ—¶

### 5. é€šè®¯å½•æƒé™ (READ_CONTACTS)

**ä½¿ç”¨åœºæ™¯ï¼š**
- ğŸ‘¥ åŒæ­¥è”ç³»äºº
- ğŸ” æŸ¥æ‰¾å¥½å‹

**ç”³è¯·æ—¶æœºï¼š**
- ç”¨æˆ·ç‚¹å‡»åŒæ­¥è”ç³»äººæ—¶
- æœç´¢è”ç³»äººæ—¶

### 6. é€šçŸ¥æƒé™ (POST_NOTIFICATIONS - Android 13+)

**ä½¿ç”¨åœºæ™¯ï¼š**
- ğŸ“¬ æ¥æ”¶æ–°æ¶ˆæ¯é€šçŸ¥
- ğŸ”” é€šè¯æé†’
- âš¡ ç³»ç»Ÿé€šçŸ¥

**ç”³è¯·æ—¶æœºï¼š**
- åº”ç”¨é¦–æ¬¡å¯åŠ¨æ—¶
- ç”¨æˆ·å¼€å¯é€šçŸ¥è®¾ç½®æ—¶

---

## ğŸ’» Androidç«¯å®ç°

### ç¬¬ä¸€æ­¥ï¼šåœ¨Activityä¸­é›†æˆ

```java
public class CallActivity extends AppCompatActivity {
    
    private PermissionManager permissionManager;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_call);
        
        permissionManager = PermissionManager.getInstance();
        
        // è®¾ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        findViewById(R.id.videoCallBtn).setOnClickListener(v -> {
            startVideoCall();
        });
        
        findViewById(R.id.voiceCallBtn).setOnClickListener(v -> {
            startVoiceCall();
        });
    }
    
    /**
     * å‘èµ·è§†é¢‘é€šè¯
     */
    private void startVideoCall() {
        // âœ… ä½¿ç”¨å‰æ£€æŸ¥å¹¶è¯·æ±‚æƒé™
        permissionManager.requestCallPermissions(this, new PermissionManager.PermissionCallback() {
            @Override
            public void onPermissionGranted() {
                // âœ… æƒé™å·²æˆäºˆï¼Œå¯ä»¥å¼€å§‹è§†é¢‘é€šè¯
                Toast.makeText(CallActivity.this, "å¼€å§‹è§†é¢‘é€šè¯...", Toast.LENGTH_SHORT).show();
                initVideoCall();
            }
            
            @Override
            public void onPermissionDenied(List<String> deniedPermissions) {
                // âŒ æƒé™è¢«æ‹’ç»
                String permissions = String.join(", ", deniedPermissions);
                Toast.makeText(CallActivity.this, 
                    "éœ€è¦" + permissions + "æƒé™æ‰èƒ½è¿›è¡Œè§†é¢‘é€šè¯", 
                    Toast.LENGTH_LONG).show();
            }
            
            @Override
            public void onPermissionPermanentlyDenied(List<String> permanentlyDeniedPermissions) {
                // â›” æƒé™è¢«æ°¸ä¹…æ‹’ç»
                showPermissionSettingsDialog();
            }
        });
    }
    
    /**
     * å‘èµ·è¯­éŸ³é€šè¯
     */
    private void startVoiceCall() {
        // âœ… åªéœ€è¦éº¦å…‹é£æƒé™
        permissionManager.requestMicrophone(this, new PermissionManager.PermissionCallback() {
            @Override
            public void onPermissionGranted() {
                Toast.makeText(CallActivity.this, "å¼€å§‹è¯­éŸ³é€šè¯...", Toast.LENGTH_SHORT).show();
                initVoiceCall();
            }
            
            @Override
            public void onPermissionDenied(List<String> deniedPermissions) {
                Toast.makeText(CallActivity.this, 
                    "éœ€è¦éº¦å…‹é£æƒé™æ‰èƒ½è¿›è¡Œè¯­éŸ³é€šè¯", 
                    Toast.LENGTH_LONG).show();
            }
            
            @Override
            public void onPermissionPermanentlyDenied(List<String> permanentlyDeniedPermissions) {
                showPermissionSettingsDialog();
            }
        });
    }
    
    /**
     * æ˜¾ç¤ºå»è®¾ç½®çš„å¯¹è¯æ¡†
     */
    private void showPermissionSettingsDialog() {
        new AlertDialog.Builder(this)
            .setTitle("éœ€è¦æƒé™")
            .setMessage("è¯·åœ¨è®¾ç½®ä¸­å¼€å¯ç›¸å…³æƒé™ï¼Œä»¥ä¾¿æ­£å¸¸ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚")
            .setPositiveButton("å»è®¾ç½®", (dialog, which) -> {
                permissionManager.openAppSettings(this);
            })
            .setNegativeButton("å–æ¶ˆ", null)
            .show();
    }
    
    /**
     * å¤„ç†æƒé™è¯·æ±‚ç»“æœ
     * âš ï¸ é‡è¦ï¼šå¿…é¡»é‡å†™æ­¤æ–¹æ³•
     */
    @Override
    public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
        // äº¤ç»™PermissionManagerå¤„ç†
        permissionManager.onRequestPermissionsResult(this, requestCode, permissions, grantResults);
    }
    
    @Override
    protected void onDestroy() {
        super.onDestroy();
        // æ¸…ç†å›è°ƒï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
        permissionManager.clearCallbacks();
    }
}
```

### ç¬¬äºŒæ­¥ï¼šå±å¹•å…±äº«æƒé™ç”³è¯·

```java
public class ScreenShareActivity extends AppCompatActivity {
    
    private PermissionManager permissionManager;
    private MediaProjectionManager mediaProjectionManager;
    private static final int REQUEST_CODE_MEDIA_PROJECTION = 2001;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_screen_share);
        
        permissionManager = PermissionManager.getInstance();
        mediaProjectionManager = (MediaProjectionManager) 
            getSystemService(Context.MEDIA_PROJECTION_SERVICE);
        
        findViewById(R.id.startShareBtn).setOnClickListener(v -> {
            startScreenShare();
        });
    }
    
    /**
     * å¼€å§‹å±å¹•å…±äº«
     */
    private void startScreenShare() {
        // âœ… ç¬¬ä¸€æ­¥ï¼šè¯·æ±‚åŸºç¡€æƒé™ï¼ˆéº¦å…‹é£ã€é€šçŸ¥ï¼‰
        permissionManager.requestScreenSharePermissions(this, 
            new PermissionManager.PermissionCallback() {
                @Override
                public void onPermissionGranted() {
                    // âœ… ç¬¬äºŒæ­¥ï¼šè¯·æ±‚å±å¹•å½•åˆ¶æƒé™
                    requestMediaProjection();
                }
                
                @Override
                public void onPermissionDenied(List<String> deniedPermissions) {
                    Toast.makeText(ScreenShareActivity.this,
                        "éœ€è¦ç›¸å…³æƒé™æ‰èƒ½è¿›è¡Œå±å¹•å…±äº«",
                        Toast.LENGTH_LONG).show();
                }
                
                @Override
                public void onPermissionPermanentlyDenied(List<String> permanentlyDeniedPermissions) {
                    showPermissionSettingsDialog();
                }
            });
    }
    
    /**
     * è¯·æ±‚å±å¹•å½•åˆ¶æƒé™ï¼ˆç³»ç»Ÿå¼¹çª—ï¼‰
     */
    private void requestMediaProjection() {
        // âœ… å¼¹å‡ºç³»ç»Ÿå±å¹•å½•åˆ¶æƒé™å¯¹è¯æ¡†
        Intent intent = mediaProjectionManager.createScreenCaptureIntent();
        startActivityForResult(intent, REQUEST_CODE_MEDIA_PROJECTION);
    }
    
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        
        if (requestCode == REQUEST_CODE_MEDIA_PROJECTION) {
            if (resultCode == RESULT_OK) {
                // âœ… ç”¨æˆ·å…è®¸äº†å±å¹•å½•åˆ¶æƒé™
                Toast.makeText(this, "å¼€å§‹å±å¹•å…±äº«...", Toast.LENGTH_SHORT).show();
                startScreenCaptureService(data);
            } else {
                // âŒ ç”¨æˆ·æ‹’ç»äº†æƒé™
                Toast.makeText(this, 
                    "éœ€è¦å±å¹•å½•åˆ¶æƒé™æ‰èƒ½å…±äº«å±å¹•", 
                    Toast.LENGTH_LONG).show();
                showScreenCaptureRationale();
            }
        }
    }
    
    /**
     * æ˜¾ç¤ºå±å¹•å½•åˆ¶æƒé™è¯´æ˜
     */
    private void showScreenCaptureRationale() {
        new AlertDialog.Builder(this)
            .setTitle("å±å¹•å…±äº«æƒé™")
            .setMessage("å±å¹•å…±äº«éœ€è¦å½•åˆ¶æ‚¨çš„å±å¹•å†…å®¹ã€‚\n\n" +
                       "è¿™æ ·å…¶ä»–å‚ä¸è€…æ‰èƒ½çœ‹åˆ°æ‚¨çš„å±å¹•ã€‚\n\n" +
                       "æ‚¨çš„å±å¹•å†…å®¹åªä¼šå‘é€ç»™é€šè¯ä¸­çš„å‚ä¸è€…ã€‚")
            .setPositiveButton("é‡è¯•", (dialog, which) -> {
                requestMediaProjection();
            })
            .setNegativeButton("å–æ¶ˆ", null)
            .show();
    }
    
    @Override
    public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults);
        permissionManager.onRequestPermissionsResult(this, requestCode, permissions, grantResults);
    }
}
```

---

## ğŸŒ Webç«¯å®ç°

### æƒé™ç”³è¯·ç¤ºä¾‹

```javascript
class PermissionRequestManager {
    
    /**
     * è¯·æ±‚ç›¸æœºæƒé™
     */
    async requestCamera() {
        try {
            // âœ… æµè§ˆå™¨ä¼šå¼¹å‡ºç³»ç»Ÿæƒé™è¯·æ±‚
            const stream = await navigator.mediaDevices.getUserMedia({ 
                video: true 
            });
            
            console.log('âœ… ç›¸æœºæƒé™å·²æˆäºˆ');
            return { granted: true, stream };
            
        } catch (error) {
            return this.handlePermissionError(error, 'ç›¸æœº');
        }
    }
    
    /**
     * è¯·æ±‚éº¦å…‹é£æƒé™
     */
    async requestMicrophone() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ 
                audio: true 
            });
            
            console.log('âœ… éº¦å…‹é£æƒé™å·²æˆäºˆ');
            return { granted: true, stream };
            
        } catch (error) {
            return this.handlePermissionError(error, 'éº¦å…‹é£');
        }
    }
    
    /**
     * è¯·æ±‚éŸ³è§†é¢‘é€šè¯æƒé™
     */
    async requestCallPermissions() {
        try {
            // âœ… åŒæ—¶è¯·æ±‚éŸ³é¢‘å’Œè§†é¢‘
            const stream = await navigator.mediaDevices.getUserMedia({
                video: true,
                audio: true
            });
            
            console.log('âœ… éŸ³è§†é¢‘æƒé™å·²æˆäºˆ');
            return { granted: true, stream };
            
        } catch (error) {
            return this.handlePermissionError(error, 'éŸ³è§†é¢‘');
        }
    }
    
    /**
     * è¯·æ±‚å±å¹•å…±äº«æƒé™
     */
    async requestScreenShare() {
        try {
            // âœ… æµè§ˆå™¨ä¼šå¼¹å‡ºå±å¹•é€‰æ‹©å¯¹è¯æ¡†
            const stream = await navigator.mediaDevices.getDisplayMedia({
                video: {
                    displaySurface: 'monitor'
                },
                audio: false
            });
            
            console.log('âœ… å±å¹•å…±äº«æƒé™å·²æˆäºˆ');
            return { granted: true, stream };
            
        } catch (error) {
            return this.handlePermissionError(error, 'å±å¹•å…±äº«');
        }
    }
    
    /**
     * è¯·æ±‚é€šçŸ¥æƒé™
     */
    async requestNotification() {
        try {
            if (!('Notification' in window)) {
                throw new Error('æµè§ˆå™¨ä¸æ”¯æŒé€šçŸ¥');
            }
            
            if (Notification.permission === 'granted') {
                return { granted: true };
            }
            
            // âœ… æµè§ˆå™¨ä¼šå¼¹å‡ºé€šçŸ¥æƒé™è¯·æ±‚
            const permission = await Notification.requestPermission();
            
            if (permission === 'granted') {
                console.log('âœ… é€šçŸ¥æƒé™å·²æˆäºˆ');
                return { granted: true };
            } else {
                return { granted: false, reason: 'ç”¨æˆ·æ‹’ç»äº†é€šçŸ¥æƒé™' };
            }
            
        } catch (error) {
            return this.handlePermissionError(error, 'é€šçŸ¥');
        }
    }
    
    /**
     * å¤„ç†æƒé™é”™è¯¯
     */
    handlePermissionError(error, permissionName) {
        let reason = '';
        
        if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
            reason = `ç”¨æˆ·æ‹’ç»äº†${permissionName}æƒé™`;
        } else if (error.name === 'NotFoundError') {
            reason = `æœªæ‰¾åˆ°${permissionName}è®¾å¤‡`;
        } else if (error.name === 'NotSupportedError') {
            reason = `æµè§ˆå™¨ä¸æ”¯æŒ${permissionName}`;
        } else {
            reason = `${permissionName}æƒé™è¯·æ±‚å¤±è´¥: ${error.message}`;
        }
        
        console.error('âŒ', reason);
        
        return {
            granted: false,
            error: error,
            reason: reason
        };
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const permissionManager = new PermissionRequestManager();

// å‘èµ·è§†é¢‘é€šè¯
async function startVideoCall() {
    const result = await permissionManager.requestCallPermissions();
    
    if (result.granted) {
        // âœ… æƒé™å·²æˆäºˆï¼Œå¼€å§‹é€šè¯
        console.log('å¼€å§‹è§†é¢‘é€šè¯');
        setupVideoCall(result.stream);
    } else {
        // âŒ æƒé™è¢«æ‹’ç»
        alert(result.reason);
        showPermissionGuide();
    }
}

// å¼€å§‹å±å¹•å…±äº«
async function startScreenShare() {
    const result = await permissionManager.requestScreenShare();
    
    if (result.granted) {
        // âœ… æƒé™å·²æˆäºˆï¼Œå¼€å§‹å…±äº«
        console.log('å¼€å§‹å±å¹•å…±äº«');
        setupScreenShare(result.stream);
    } else {
        // âŒ æƒé™è¢«æ‹’ç»
        alert(result.reason);
    }
}
```

---

## ğŸ“± å®Œæ•´çš„æƒé™ç”³è¯·æµç¨‹

### æµç¨‹å›¾

```
ç”¨æˆ·ç‚¹å‡»åŠŸèƒ½æŒ‰é’®
     â†“
æ£€æŸ¥æ˜¯å¦å·²æœ‰æƒé™
     â†“
     â”œâ”€ å·²æœ‰ â†’ ç›´æ¥ä½¿ç”¨åŠŸèƒ½
     â”‚
     â””â”€ æ²¡æœ‰ â†’ æ˜¾ç¤ºæƒé™è¯´æ˜å¯¹è¯æ¡†
                    â†“
               ç”¨æˆ·ç‚¹å‡»"æˆäºˆæƒé™"
                    â†“
           å¼¹å‡ºç³»ç»Ÿæƒé™è¯·æ±‚çª—å£ âœ¨
                    â†“
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                   â”‚
        å…è®¸                æ‹’ç»
          â”‚                   â”‚
     å¼€å§‹ä½¿ç”¨åŠŸèƒ½        è®°å½•æ‹’ç»çŠ¶æ€
          â”‚                   â”‚
          â”‚              æ˜¯å¦æ°¸ä¹…æ‹’ç»?
          â”‚                   â”‚
          â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚         æ˜¯                 å¦
          â”‚          â”‚                  â”‚
          â”‚     å¼•å¯¼å»è®¾ç½®        æç¤ºåŸå› +é‡è¯•
          â”‚          â”‚                  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æ—¶æœº

#### 1. è§†é¢‘é€šè¯

```
ç”¨æˆ·ç‚¹å‡»è§†é¢‘é€šè¯
    â†“
æ˜¾ç¤ºè¯´æ˜ï¼š"éœ€è¦ç›¸æœºå’Œéº¦å…‹é£æƒé™æ‰èƒ½è¿›è¡Œè§†é¢‘é€šè¯"
    â†“
ç”¨æˆ·ç‚¹å‡»"æˆäºˆæƒé™"
    â†“
âœ¨ ç³»ç»Ÿå¼¹çª—ï¼šå…è®¸[åº”ç”¨å]è®¿é—®æ‚¨çš„ç›¸æœºå’Œéº¦å…‹é£å—ï¼Ÿ
    â†“
ç”¨æˆ·ç‚¹å‡»"å…è®¸"
    â†“
å¼€å§‹è§†é¢‘é€šè¯
```

#### 2. å±å¹•å…±äº«

```
ç”¨æˆ·ç‚¹å‡»å±å¹•å…±äº«
    â†“
æ£€æŸ¥éº¦å…‹é£æƒé™
    â†“
âœ¨ ç³»ç»Ÿå¼¹çª—ï¼šå…è®¸[åº”ç”¨å]å½•åˆ¶éŸ³é¢‘å—ï¼Ÿ
    â†“
ç”¨æˆ·ç‚¹å‡»"å…è®¸"
    â†“
âœ¨ ç³»ç»Ÿå¼¹çª—ï¼šé€‰æ‹©è¦å…±äº«çš„å†…å®¹ï¼ˆæ•´ä¸ªå±å¹•/çª—å£/æ ‡ç­¾é¡µï¼‰
    â†“
ç”¨æˆ·é€‰æ‹©å¹¶ç‚¹å‡»"å…±äº«"
    â†“
å¼€å§‹å±å¹•å…±äº«
```

#### 3. å‘é€è¯­éŸ³æ¶ˆæ¯

```
ç”¨æˆ·æŒ‰ä½å½•éŸ³æŒ‰é’®
    â†“
âœ¨ ç³»ç»Ÿå¼¹çª—ï¼šå…è®¸[åº”ç”¨å]å½•åˆ¶éŸ³é¢‘å—ï¼Ÿ
    â†“
ç”¨æˆ·ç‚¹å‡»"å…è®¸"
    â†“
å¼€å§‹å½•éŸ³
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æƒé™è¯·æ±‚æ—¶æœº

âœ… **æ­£ç¡®**ï¼š
- ç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»åŠŸèƒ½æ—¶
- åŠŸèƒ½ä½¿ç”¨å‰çš„å³æ—¶è¯·æ±‚
- æœ‰æ¸…æ™°çš„ä¸Šä¸‹æ–‡è¯´æ˜

âŒ **é”™è¯¯**ï¼š
- åº”ç”¨å¯åŠ¨æ—¶æ‰¹é‡è¯·æ±‚æ‰€æœ‰æƒé™
- æ²¡æœ‰è¯´æ˜å°±çªç„¶è¯·æ±‚
- é‡å¤éªšæ‰°å·²æ‹’ç»çš„ç”¨æˆ·

### 2. æƒé™è¯´æ˜

âœ… **æ­£ç¡®**ï¼š
```
éœ€è¦ç›¸æœºæƒé™æ‰èƒ½è¿›è¡Œè§†é¢‘é€šè¯

ç‚¹å‡»"æˆäºˆæƒé™"åï¼Œç³»ç»Ÿä¼šå¼¹å‡ºæƒé™è¯·æ±‚çª—å£ã€‚
```

âŒ **é”™è¯¯**ï¼š
```
éœ€è¦æƒé™
```

### 3. æ°¸ä¹…æ‹’ç»å¤„ç†

âœ… **æ­£ç¡®**ï¼š
```
æ‚¨å·²æ‹’ç»ç›¸æœºæƒé™ã€‚

å¦‚éœ€ä½¿ç”¨è§†é¢‘é€šè¯ï¼Œè¯·ï¼š
1. ç‚¹å‡»"å»è®¾ç½®"
2. æ‰¾åˆ°"æƒé™ç®¡ç†"
3. å¼€å¯"ç›¸æœº"æƒé™
```

âŒ **é”™è¯¯**ï¼š
```
æƒé™è¢«æ‹’ç»ï¼ŒåŠŸèƒ½æ— æ³•ä½¿ç”¨ã€‚
```

### 4. Androidç‰ˆæœ¬å…¼å®¹

```java
// âœ… æ£€æŸ¥Androidç‰ˆæœ¬
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
    // Android 13+ éœ€è¦é¢å¤–çš„é€šçŸ¥æƒé™
    permissions.add(Manifest.permission.POST_NOTIFICATIONS);
}

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
    // Android 11+ ä½¿ç”¨æ–°çš„å­˜å‚¨æƒé™
    permissions.add(Manifest.permission.MANAGE_EXTERNAL_STORAGE);
}
```

---

## ğŸ“Š æƒé™çŠ¶æ€æ£€æŸ¥

### Android

```java
// æ£€æŸ¥å•ä¸ªæƒé™
boolean hasCamera = permissionManager.hasCameraPermission(context);

// æ£€æŸ¥å¤šä¸ªæƒé™
boolean hasCallPermissions = permissionManager.hasCallPermissions(context);

// åœ¨ä½¿ç”¨å‰æ£€æŸ¥
if (!permissionManager.hasCameraPermission(this)) {
    // è¯·æ±‚æƒé™
    permissionManager.requestCamera(this, callback);
} else {
    // ç›´æ¥ä½¿ç”¨
    startCamera();
}
```

### Web

```javascript
// æ£€æŸ¥æƒé™çŠ¶æ€
async function checkPermissionStatus() {
    try {
        // æ£€æŸ¥ç›¸æœº
        const cameraStatus = await navigator.permissions.query({ name: 'camera' });
        console.log('ç›¸æœºæƒé™:', cameraStatus.state); // 'granted', 'denied', 'prompt'
        
        // æ£€æŸ¥éº¦å…‹é£
        const micStatus = await navigator.permissions.query({ name: 'microphone' });
        console.log('éº¦å…‹é£æƒé™:', micStatus.state);
        
        // ç›‘å¬æƒé™å˜åŒ–
        cameraStatus.addEventListener('change', () => {
            console.log('ç›¸æœºæƒé™å˜åŒ–:', cameraStatus.state);
        });
        
    } catch (error) {
        console.error('æ£€æŸ¥æƒé™å¤±è´¥:', error);
    }
}
```

---

## âœ… æœ€ä½³å®è·µæ€»ç»“

### 1. æƒé™è¯·æ±‚çš„é»„é‡‘æ³•åˆ™

1. **æŒ‰éœ€è¯·æ±‚** - åªåœ¨éœ€è¦æ—¶è¯·æ±‚ï¼Œä¸è¦ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰æƒé™
2. **æ¸…æ™°è¯´æ˜** - å‘Šè¯‰ç”¨æˆ·ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªæƒé™
3. **ç³»ç»Ÿå¼¹çª—** - ä½¿ç”¨ç³»ç»ŸåŸç”Ÿæƒé™å¯¹è¯æ¡†ï¼Œä¸è¦è‡ªå®šä¹‰
4. **å°Šé‡é€‰æ‹©** - ç”¨æˆ·æ‹’ç»åä¸è¦åå¤éªšæ‰°
5. **æä¾›å¼•å¯¼** - æ°¸ä¹…æ‹’ç»åæä¾›å»è®¾ç½®çš„æ˜ç¡®è·¯å¾„

### 2. ç”¨æˆ·ä½“éªŒä¼˜åŒ–

1. **ä¸Šä¸‹æ–‡ç›¸å…³** - åœ¨ç”¨æˆ·æ‰§è¡Œç›¸å…³æ“ä½œæ—¶è¯·æ±‚æƒé™
2. **åˆ†æ­¥è¯·æ±‚** - ä¸è¦ä¸€æ¬¡è¯·æ±‚å¤ªå¤šæƒé™
3. **å‹å¥½æç¤º** - æƒé™è¢«æ‹’åç»™å‡ºå‹å¥½çš„æç¤ºå’Œè§£å†³æ–¹æ¡ˆ
4. **ä¼˜é›…é™çº§** - éƒ¨åˆ†æƒé™ç¼ºå¤±æ—¶æä¾›æ›¿ä»£åŠŸèƒ½

### 3. ä»£ç å¥å£®æ€§

1. **é”™è¯¯å¤„ç†** - å¤„ç†æ‰€æœ‰å¯èƒ½çš„æƒé™çŠ¶æ€
2. **ç‰ˆæœ¬å…¼å®¹** - è€ƒè™‘ä¸åŒAndroidç‰ˆæœ¬çš„æƒé™å·®å¼‚
3. **å†…å­˜ç®¡ç†** - åŠæ—¶æ¸…ç†æƒé™å›è°ƒï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
4. **çŠ¶æ€æ£€æŸ¥** - ä½¿ç”¨å‰å§‹ç»ˆæ£€æŸ¥æƒé™çŠ¶æ€

---

## ğŸ“ æ£€æŸ¥æ¸…å•

### å¼€å‘é˜¶æ®µ

- [ ] æ‰€æœ‰éœ€è¦æƒé™çš„åŠŸèƒ½éƒ½åœ¨ä½¿ç”¨å‰è¯·æ±‚
- [ ] æ‰€æœ‰æƒé™è¯·æ±‚éƒ½æœ‰æ¸…æ™°çš„è¯´æ˜
- [ ] å¤„ç†äº†ç”¨æˆ·æ‹’ç»æƒé™çš„æƒ…å†µ
- [ ] å¤„ç†äº†ç”¨æˆ·æ°¸ä¹…æ‹’ç»æƒé™çš„æƒ…å†µ
- [ ] æä¾›äº†å»è®¾ç½®é¡µé¢çš„å…¥å£
- [ ] å…¼å®¹ä¸åŒAndroidç‰ˆæœ¬
- [ ] æ²¡æœ‰å†…å­˜æ³„æ¼

### æµ‹è¯•é˜¶æ®µ

- [ ] é¦–æ¬¡ä½¿ç”¨æ—¶èƒ½æ­£ç¡®å¼¹å‡ºæƒé™è¯·æ±‚
- [ ] å…è®¸æƒé™ååŠŸèƒ½æ­£å¸¸
- [ ] æ‹’ç»æƒé™åæç¤ºæ­£ç¡®
- [ ] æ°¸ä¹…æ‹’ç»åå¼•å¯¼æ­£ç¡®
- [ ] åœ¨è®¾ç½®ä¸­æˆæƒåè¿”å›åº”ç”¨åŠŸèƒ½æ­£å¸¸
- [ ] ä¸åŒå“ç‰Œæ‰‹æœºæµ‹è¯•é€šè¿‡
- [ ] ä¸åŒAndroidç‰ˆæœ¬æµ‹è¯•é€šè¿‡

---

**æœ€åæ›´æ–°**: 2025å¹´10æœˆ9æ—¥  
**ç»´æŠ¤è€…**: å¿—èˆªå¯†ä¿¡å›¢é˜Ÿ


